

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ru" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ru" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Вступление &mdash; документация Документация API VirusTotal 1.0</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Алфавитный указатель" href="genindex.html" />
    <link rel="search" title="Поиск" href="search.html" />
    <link rel="next" title="Основные функции VirusTotal API" href="endpoints.html" />
    <link rel="prev" title="API VirusTotal (3 version)" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Документация API VirusTotal
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Вступление</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">Краткий обзор</a></li>
<li class="toctree-l2"><a class="reference internal" href="#premium-api">Различия публичного и Premium API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">Начало работы</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id8">Аутентификация</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api">Ответы API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">Структура ответа</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id10">Ошибки</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id11">Формат ответа в случае ошибки</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id12">Ключевые концепции</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id13">Объекты</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id14">Пример ответа</a></li>
<li class="toctree-l3"><a class="reference internal" href="#patch">Пример PATCH-запроса</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id15">Коллекции</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id16">Пример ответа коллекции</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id17">Отношения</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id18">Отношения в объекте</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="endpoints.html">Основные функции VirusTotal API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Документация API VirusTotal</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Вступление</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/intro.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>Вступление<a class="headerlink" href="#id1" title="Ссылка на этот заголовок">¶</a></h1>
<div class="section" id="id2">
<h2>Краткий обзор<a class="headerlink" href="#id2" title="Ссылка на этот заголовок">¶</a></h2>
<p>VirusTotal API 3 версии на данный момент находится в стадии бета-версии. Данная версия заменит <a class="reference external" href="https://developers.virustotal.com/v2.0">VirusTotal API 2 версии</a> с течением определенного времени. Версия 3 VirusTotal API основана на спецификации <a class="reference external" href="http://jsonapi.org/">http://jsonapi.org/</a> и была разработана с учетом простоты использования и единообразия.</p>
<p>irusTotal API 3 версии следует принципам <a class="reference external" href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST</a> и имеет предсказуемые, ориентированные на ресурсы URL-адреса. В этой версии API для запросов и ответов (в том числе и ответов с информацией об ошибках) используется JSON.</p>
<div class="admonition warning">
<p class="admonition-title">Предупреждение</p>
<p>VirusTotal API 3 версии уже достаточно стабилен, однако некоторые несовместимые изменения по-прежнему возможны. Мы рекомендуем вам начать использовать его для экспериментов и не критически важных проектов.</p>
</div>
</div>
<div class="section" id="premium-api">
<h2>Различия публичного и Premium API<a class="headerlink" href="#premium-api" title="Ссылка на этот заголовок">¶</a></h2>
<p>Хотя многие функции, предоставляемые API VirusTotal, свободно доступны всем зарегистрированным пользователям, некоторые из них доступны только нашими премиум-клиентами. Эти функции составляют VirusTotal Premium API, и они будут соответствующим образом идентифицированы в этом описании.</p>
<p>Premium API - это компонент <a class="reference external" href="https://www.virustotal.com/gui/services-overview">расширенных сервисов VirusTotal для профессионалов</a>.</p>
<p>Публичный (открытый) API, с другой стороны, представляет собой набор функций, доступных для всех пользователей без каких-либо затрат. Единственное, что вам нужно для использования открытого API, это зарегистрироваться в сообществе VirusTotal и получить ключ API, как описано в разделе «<a class="reference internal" href="#id4">Начало работы</a>».</p>
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Ограничения публичного API</p>
</div>
<ul class="simple">
<li><p>Публичный API ограничен 4 запросами в минуту и 1000 запросами в день.</p></li>
<li><p>Публичный API не должен использоваться в коммерческих продуктах или услугах.</p></li>
<li><p>Публичный API не должен использоваться в бизнес-процессах, которые не вносят новых файлов.</p></li>
</ul>
<hr class="docutils" />
<div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Основные моменты Premium API</p>
</div>
<ul class="simple">
<li><p>Premium API не имеет ограничений по скорости запросов или суточных ограничений. Ограничения регулируются SLA (соглашением об уровне услуг).</p></li>
<li><p>Premium API возвращает больше данных об угрозах и предоставляет больше функциональных возможностей.</p></li>
<li><p>Premium API регулируется SLA (соглашением об уровне услуг), который гарантирует готовность данных.</p></li>
</ul>
<hr class="docutils" />
<p>Premium API имеет следующие <strong>преимущества перед публичным API:</strong></p>
<ul class="simple">
<li><p>Позволяет выбрать частоту запросов и суточную квоту, которая наилучшим образом соответствует вашим потребностям.</p></li>
<li><p>Позволяет загружать образцы для дальнейшего исследования, а также данные о сетевом трафике, которые они генерируют при выполнении, и подробные отчеты о выполнении.</p></li>
<li><p>Возможно получение дополнительной информации об объектах, обработанных VirusTotal, например: предупреждения потока кода VBA для документов, исходные метаданные, выходные данные ExifTool, выходные данные IDS для зарегистрированных сетевых трасс, рейтинги популярности доменов, сертификаты SSL и т. д.</p></li>
<li><p>Включает метаданные, сгенерированные исключительно VirusTotal: первая дата отправки файла, список имен файлов, с которыми файл был отправлен в VirusTotal, страны отправки, распространенность и т. д.</p></li>
<li><p>Предоставит вам доступ к информации о поведении файлов, созданной в результате выполнения Windows PE, DMG, Mach-O и APK файлов в виртуализированной среде песочницы.</p></li>
<li><p>Предоставляет сведения о «белых списках» и <a class="reference external" href="http://blog.virustotal.com/2015/02/a-first-shot-at-false-positives.html">доверенных источниках</a>.</p></li>
<li><p>Позволяет задавать правила для запросов образцов, например: образцы с определенной сигнатурой; образцы, которые обнаружены более чем 10 антивирусными движками; образцы, которые содержат нужный раздел PE с определенным хэшем и т.д. Эти модификаторы поиска могут быть объединены для создания сложных запросов.</p></li>
<li><p>Позволяет задавать правила для запросов URL, доменов, IP-адресов, например: все домены, зарегистрированные одним и тем же злоумышленником; все домены с TTL записи DNS A менее 5 секунд и т.д.</p></li>
<li><p>Предоставляет возможность кластеризации файлов и поиска похожих файлов.</p></li>
<li><p>Показывает расширенные связи, которые недоступны в публичном API, например: встроенные домены; встроенные IP-адреса; контактные домены и т. д.</p></li>
<li><p>Позволяет программно взаимодействовать с VT Hunting, включая получение уведомлений о правилах YARA или автоматический запуск заданий ретро-поиска.</p></li>
<li><p>Имеет строгое соглашение о предоставлении услуг (SLA), которое гарантирует доступность и готовность данных.</p></li>
</ul>
<p>В частности, Premium API поддерживает следующие <strong>основные варианты использования:</strong></p>
<ul class="simple">
<li><p>Автоматизация рабочих процессов с помощью набора данных VirusTotal, включая программное расширение предупреждений.</p></li>
<li><p>Интеграция VirusTotal с вашим SIEM, SOAR, EDR или AV для целей расширения получаемой информации, а не обнаружения.</p></li>
<li><p>Скачивание файлов для дальнейшего изучения в автономном режиме.</p></li>
<li><p>Полная характеристика любого вида угрозы, которую можно наблюдать: файлы, URL-адреса, Домены, IP-адреса, SSL-сертификаты и т. д.</p></li>
</ul>
</div>
<div class="section" id="id4">
<h2>Начало работы<a class="headerlink" href="#id4" title="Ссылка на этот заголовок">¶</a></h2>
<p>Для использования API необходимо зарегистрироваться в сообществе <a class="reference external" href="https://www.virustotal.com/gui/join-us">VirusTotal Community</a>. Как только у вас будет действительная учетная запись VirusTotal Community, вы найдете свой личный ключ доступа к API в разделе личных настроек. Этот ключ - все, что вам нужно для использования VirusTotal API.</p>
<div class="admonition warning">
<p class="admonition-title">Предупреждение</p>
<p>VirusTotal API не должен использоваться в коммерческих продуктах или услугах, он не может использоваться в качестве замены антивирусных продуктов и не может быть интегрирован в любой проект, который может нанести прямой или косвенный ущерб антивирусной индустрии. Несоблюдение этих условий приведет к немедленному запрету доступа нарушителя к VirusTotal API.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Предупреждение</p>
<p>При любых обстоятельствах <a class="reference external" href="https://support.virustotal.com/hc/en-us/articles/115002145529-Terms-of-Service">Условия предоставления услуг</a> и <a class="reference external" href="https://support.virustotal.com/hc/en-us/articles/115002168385-Privacy-Policy">Политика конфиденциальности</a> VirusTotal должны соблюдаться.</p>
</div>
<p>По умолчанию любой зарегистрированный пользователь VirusTotal Community имеет право на ключ API, который позволяет ему взаимодействовать с базовым набором функций API. Расширенные вызовы доступны через Premium API, который требует специальных привилегий. <a class="reference external" href="https://www.virustotal.com/gui/contact-us/premium-services">Свяжитесь с нами</a>, если вы хотите узнать больше о том, как получить доступ к  Premium API.</p>
<img alt="https://i.imgur.com/LFvGYQi.png" src="https://i.imgur.com/LFvGYQi.png" />
</div>
<div class="section" id="id8">
<h2>Аутентификация<a class="headerlink" href="#id8" title="Ссылка на этот заголовок">¶</a></h2>
<p>Для аутентификации с помощью API вы должны включить заголовок x-apikey со своим личным ключом API во все ваши запросы. Ваш ключ API можно найти в пользовательском меню вашей учетной записи VirusTotal:</p>
<img alt="https://i.imgur.com/tby8XLV.png" src="https://i.imgur.com/tby8XLV.png" />
<p>Ваш ключ доступа к API несет все ваши привилегии, поэтому держите его в безопасности и не делитесь им ни с кем. Всегда используйте HTTPS вместо HTTP для выполнения ваших запросов.</p>
</div>
<div class="section" id="api">
<h2>Ответы API<a class="headerlink" href="#api" title="Ссылка на этот заголовок">¶</a></h2>
<p>В большинстве случаев ресурс VirusTotal API возвращает ответ в формате JSON. Если не указано иное, ответ на успешный запрос будет иметь следующий формат:</p>
<div class="section" id="id9">
<h3>Структура ответа<a class="headerlink" href="#id9" title="Ссылка на этот заголовок">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">response</span> <span class="n">data</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&lt;response</span> <span class="pre">data&gt;</span></code> обычно представляет собой объект или список объектов, однако это не всегда так. Примером этого является функция <code class="docutils literal notranslate"><span class="pre">/files/upload_url</span></code>, которая возвращает URL-адрес.</p>
</div>
</div>
<div class="section" id="id10">
<h2>Ошибки<a class="headerlink" href="#id10" title="Ссылка на этот заголовок">¶</a></h2>
<p>API VirusTotal следует обычным кодам ответа HTTP для указания успеха или неудачи. Коды в диапазоне <code class="docutils literal notranslate"><span class="pre">2xx</span></code> указывают на успех. Коды в диапазоне <code class="docutils literal notranslate"><span class="pre">4xx</span></code> указывают на ошибку в запросе (например, отсутствует параметр или ресурс не найден). Коды в диапазоне <code class="docutils literal notranslate"><span class="pre">5xx</span></code> указывают на ошибку на серверах VirusTotal, что бывает крайне редко.</p>
<p>Неудачные запросы возвращают дополнительную информацию об ошибке в формате JSON:</p>
<div class="section" id="id11">
<h3>Формат ответа в случае ошибки<a class="headerlink" href="#id11" title="Ссылка на этот заголовок">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;error code&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;a message describing the error&gt;&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Код ошибки <code class="docutils literal notranslate"><span class="pre">code</span></code> представляет собой строку с одним из значений, приведенных в ниже.</p>
<p>Сообщение <code class="docutils literal notranslate"><span class="pre">message</span></code> содержит ,более подробную информацию об ошибке.</p>
<ul class="simple">
<li><p><strong>409</strong> - Ошибка типа «AlreadyExistsError». Ресурс уже существует.</p></li>
<li><p><strong>401</strong> - Ошибка типа «AuthenticationRequiredError». Выполнение операции возможно аутентифицированным пользователем. Убедитесь, что вы предоставили свой ключ доступа к API.</p></li>
<li><p><strong>400</strong> - Ошибка типа «BadRequestError». Запрос API является недопустимым или неправильным.</p></li>
<li><p><strong>403</strong> - Ошибка типа «ForbiddenError». Выполнение запрошенной операции невозможно.</p></li>
<li><p><strong>400</strong> - Ошибка типа «InvalidArgumentError». Некоторые аргументы, переданные в запросе неверные.</p></li>
<li><p><strong>404</strong> - Ошибка типа «NotFoundError» - Запрошенный ресурс не найден.</p></li>
<li><p><strong>429</strong> - Ошибка типа «QuotaExceededError». Превышение одной из квот на число запросов(минутной, ежедневной или ежемесячной). Ежедневные квоты сбрасываются каждый день в 00: 00 UTC.</p></li>
<li><p><strong>429</strong> - Ошибка типа «TooManyRequestsError». Большое число запросов.</p></li>
<li><p><strong>401</strong> - Ошибка типа «UserNotActiveError». Учетная запись пользователя не активна.</p></li>
<li><p><strong>401</strong> - Ошибка типа «WrongCredentialsError».- Ключ доступа к API является неверным.</p></li>
<li><p><strong>503</strong> - Ошибка типа «TransientError». Временная ошибка сервера. Повторная попытка запроса может сработать.</p></li>
</ul>
</div>
</div>
<div class="section" id="id12">
<h2>Ключевые концепции<a class="headerlink" href="#id12" title="Ссылка на этот заголовок">¶</a></h2>
<p>VirusTotal API (версии 3) базируется на трех ключевых понятиях: <a class="reference internal" href="#id13">объекты</a> (<code class="docutils literal notranslate"><span class="pre">objects</span></code>), <a class="reference internal" href="#id15">коллекции</a> (<code class="docutils literal notranslate"><span class="pre">collections</span></code>) и <a class="reference internal" href="#id17">отношения</a> (<code class="docutils literal notranslate"><span class="pre">relationships</span></code>).</p>
<p><strong>Объект</strong> - это любой элемент, который может быть получен или обработан с помощью API. Файлы, URL-адреса, доменные имена и наборы правил поиска VirusTotal - это некоторые типы объектов, предоставляемые API.</p>
<p><strong>Коллекция</strong> - это набор объектов. Объекты в коллекции обычно имеют один и тот же тип, но есть несколько исключений из этого правила. Некоторые операции API выполняются с объектами, а некоторые - с коллекциями.</p>
<p><strong>Отношения</strong> - это связи между объектами, например: файл может быть связан с другим файлом, потому что один из файлов является ZIP-архивом, который содержит другой файл, URL-адрес может быть связан с файлом, потому что файл был загружен с URL-адреса, доменное имя связано со всеми URL-адресами в этом домене.</p>
</div>
<div class="section" id="id13">
<h2>Объекты<a class="headerlink" href="#id13" title="Ссылка на этот заголовок">¶</a></h2>
<p>Объект является ключевым понятием в API VirusTotal. Каждый объект имеет идентификатор и тип. Идентификаторы уникальны среди объектов одного типа. Это означает, что пара (тип, идентификатор) однозначно идентифицирует любой объект в API. В этой документации эти пары (тип, идентификатор) называются дескрипторами объектов.</p>
<p>Каждый объект имеет связанный с ним URL-адрес со следующей структурой:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">virustotal</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="p">{</span><span class="n">collection</span> <span class="n">name</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="nb">object</span> <span class="nb">id</span><span class="p">}</span>
</pre></div>
</div>
<p>Обычно <code class="docutils literal notranslate"><span class="pre">{collection</span> <span class="pre">name}</span></code> - это множественная форма типа объекта, например, <code class="docutils literal notranslate"><span class="pre">files</span></code> - это коллекция, содержащая все объекты типа <code class="docutils literal notranslate"><span class="pre">file</span></code>, а <code class="docutils literal notranslate"><span class="pre">analyses</span></code> - это коллекция, содержащая все объекты <code class="docutils literal notranslate"><span class="pre">analysis</span></code>. Формат <code class="docutils literal notranslate"><span class="pre">{object</span> <span class="pre">id}</span></code> варьируется от одного типа объекта к другому.</p>
<p>GET-запрос на URL объекта возвращает информацию об этом объекте в следующем формате:</p>
<div class="section" id="id14">
<h3>Пример ответа<a class="headerlink" href="#id14" title="Ссылка на этот заголовок">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;{object type}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;{object id}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.virustotal.com/api/v3/{collection name}/{object id}&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;attributes&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;integer_attribute&quot;</span><span class="p">:</span> <span class="mi">1234</span><span class="p">,</span>
      <span class="s2">&quot;string_attribute&quot;</span><span class="p">:</span> <span class="s2">&quot;this is a string&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dictionary_attribute&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;one&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">},</span>
      <span class="s2">&quot;list_attribute&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span> <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">&quot;relationships&quot;</span> <span class="p">:</span> <span class="p">{</span>
       <span class="o">..</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Помимо идентификатора и типа, объект имеет набор атрибутов и отношений. Атрибуты могут быть любого типа, поддерживаемого JSON, включая списки и словари. Поле <code class="docutils literal notranslate"><span class="pre">attributes</span></code> всегда присутствует во всех объектах, а поле <code class="docutils literal notranslate"><span class="pre">relationships</span></code> является необязательными, в зависимости от того, просили ли вы включить данное поле при отправке запроса. Данный вопрос будет подробно обсуждаться в разделе «<a class="reference internal" href="#id17">Отношения</a>».</p>
<p>Каждый тип объекта имеет свой собственный заранее определенный набор атрибутов, вы не сможете добавлять или удалять атрибуты, вы можете только изменять значения существующих (в случае если они доступны для записи). Для изменения значений атрибутов объекта необходимо отправить PATCH-запрос по URL объекта. Если вы попытаетесь изменить атрибут только для чтения, вы получите сообщение об ошибке. PATCH-запрос должен содержать атрибуты, которые вы хотите изменить в структуре, подобной той, что показана в приведенном ниже примере. Любой атрибут, не включенный в запрос, останется неизменным.</p>
</div>
<div class="section" id="patch">
<h3>Пример PATCH-запроса<a class="headerlink" href="#patch" title="Ссылка на этот заголовок">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;{object type}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;{object id}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;attributes&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;integer_attribute&quot;</span><span class="p">:</span> <span class="mi">1234</span><span class="p">,</span>
      <span class="s2">&quot;string_attribute&quot;</span><span class="p">:</span> <span class="s2">&quot;this is a new string&quot;</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Обратите внимание, что идентификатор <code class="docutils literal notranslate"><span class="pre">id</span></code> и тип объекта <code class="docutils literal notranslate"><span class="pre">object</span></code> включены в PATCH-запрос, и они должны соответствовать указанным в URL.</p>
<p>Некоторые типы объектов также можно удалить, отправив DELETE-запрос на удаление по URL объекта.</p>
</div>
</div>
<div class="section" id="id15">
<h2>Коллекции<a class="headerlink" href="#id15" title="Ссылка на этот заголовок">¶</a></h2>
<p>Коллекции - это наборы объектов. Для большинства типов объектов существует коллекция верхнего уровня, представляющая все объекты этого типа. Доступ к этим коллекциям можно получить с помощью URL-адреса, например:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">virustotal</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="p">{</span><span class="n">collection</span> <span class="n">name</span><span class="p">}</span>
</pre></div>
</div>
<p>Большинство операций в API VirusTotal осуществляется путем отправки запросов к коллекции. Например, вы можете проанализировать файл, отправив POST-запрос в <code class="docutils literal notranslate"><span class="pre">/api/v3/files</span></code>, который успешно добавит новый элемент в коллекцию файлов. Вы можете создать новый набор правил VT Hunting, отправив POST-запрос в <code class="docutils literal notranslate"><span class="pre">`/api/v3</span> <span class="pre">/intelligence/hunting_rulesets</span></code>. Отправка POST-запроса в коллекцию обычно приводит к созданию новых объектов.</p>
<p>Аналогично, DELETE-запрос, отправляемый в коллекцию, приводит к удалению всех объектов в этой коллекции. Конечно, для определенных коллекций, таких как <code class="docutils literal notranslate"><span class="pre">files</span></code>, <code class="docutils literal notranslate"><span class="pre">urls</span></code> или <code class="docutils literal notranslate"><span class="pre">analyses</span></code> нет метода DELETE для запросов, но вы можете использовать DELETE-запрос с <code class="docutils literal notranslate"><span class="pre">/api/v3/intelligence/hunting_notifications</span></code>, который, как вы уже поняли, удаляет все ваши уведомления VT Hunting.</p>
<p>Большинство коллекций являются итеративными, вы можете извлечь все объекты в коллекции, отправив в коллекцию последовательные GET-запросы. На каждый запрос вы получаете ряд объектов и курсор <cite>cursor</cite>, который можно использовать для продолжения итерации. Приведенный ниже фрагмент иллюстрирует ответ на GET-запрос на <code class="docutils literal notranslate"><span class="pre">/api/v3/{collection</span> <span class="pre">name}</span></code>.</p>
<div class="section" id="id16">
<h3>Пример ответа коллекции<a class="headerlink" href="#id16" title="Ссылка на этот заголовок">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="o">..</span> <span class="nb">object</span> <span class="mi">1</span> <span class="o">..</span> <span class="p">},</span>
      <span class="p">{</span> <span class="o">..</span> <span class="nb">object</span> <span class="mi">2</span> <span class="o">..</span> <span class="p">},</span>
      <span class="p">{</span> <span class="o">..</span> <span class="nb">object</span> <span class="mi">3</span> <span class="o">..</span> <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;CuABChEKBGRhdGUSCQjA1..&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;next&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.virustotal.com/api/v3/{collection name}?cursor=CuABChEKBGRhdGUSCQjA1..&quot;</span><span class="p">,</span>
        <span class="s2">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.virustotal.com/api/v3/{collection name}&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Как следует из поля <code class="docutils literal notranslate"><span class="pre">next</span></code> в разделе <code class="docutils literal notranslate"><span class="pre">links</span></code>, вы можете использовать <code class="docutils literal notranslate"><span class="pre">cursor</span></code> в качестве параметра при последующем вызове для получения следующего набора объектов. Вы также можете использовать параметр <code class="docutils literal notranslate"><span class="pre">limit</span></code> для управления количеством объектов, возвращаемых при каждом вызове.</p>
</div>
</div>
<div class="section" id="id17">
<h2>Отношения<a class="headerlink" href="#id17" title="Ссылка на этот заголовок">¶</a></h2>
<p>Отношения - это способ, которым API-интерфейс VirusTotal выражает связи или зависимости между объектами. Объект может быть связан с объектами того же или другого типа. Например, файловый объект может быть связан с некоторым другим файловым объектом, который содержит первый, или файловый объект может быть связан с объектами URL, представляющими URL, встроенные в файл.</p>
<p>Отношения могут быть вида «один к одному» или «один ко многим», в зависимости от того, связан объект с одним объектом или с несколькими объектами.</p>
<p>При извлечении какого-либо объекта с помощью GET-запроса можно также получить его связи с другими объектами. Это можно сделать, указав отношение, которое вы хотите получить в параметре <code class="docutils literal notranslate"><span class="pre">relationships</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://www.virustotal.com/api/v3/{collection name}/{object id}?relationships={relationship}
</pre></div>
</div>
<p>Можно указать несколько отношений в параметре <cite>relationships</cite>, перечислив их имена через запятую:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://www.virustotal.com/api/v3/{collection name}/{object id}?relationships={relationship 1},{relationship 2}
</pre></div>
</div>
<p>Объекты, возвращаемые такими запросами, включают словарь отношений, где ключи - это имена запрашиваемых отношений, а значения - это либо дескриптор объекта (если отношение одно к одному), либо коллекция, как описано в разделе «<a class="reference internal" href="#id15">Коллекции</a>» (если отношение одно ко многим). Однако обратите внимание, что эти коллекции содержат не все связанные объекты, а только их дескрипторы (т. е. их тип и идентификатор).</p>
<div class="section" id="id18">
<h3>Отношения в объекте<a class="headerlink" href="#id18" title="Ссылка на этот заголовок">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;{object type}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;{object id}&quot;</span><span class="p">,</span>
  <span class="s2">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.virustotal.com/api/v3/{collection name}/{object id}&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;attributes&quot;</span> <span class="p">:</span> <span class="p">{</span>
     <span class="o">..</span>
  <span class="p">},</span>
  <span class="s2">&quot;relationships&quot;</span> <span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;{one-to-one relationship}&quot;</span><span class="p">:</span> <span class="p">{</span>
       <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;www.google.com&quot;</span><span class="p">,</span>
         <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;domain&quot;</span>
       <span class="p">},</span>
       <span class="s2">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;related&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.virustotal.com/api/v3/{collection name}/{object id}/{one-to-one relationship}&quot;</span><span class="p">,</span>
         <span class="s2">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.virustotal.com/api/v3/{collection name}/{object id}/relationships/{one-to-one relationship}&quot;</span>
       <span class="p">}</span>
     <span class="p">},</span>
     <span class="s2">&quot;{one-to-many relationship}&quot;</span><span class="p">:</span> <span class="p">{</span>
       <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">{</span> <span class="o">..</span> <span class="nb">object</span> <span class="n">descriptor</span> <span class="mi">1</span> <span class="o">..</span> <span class="p">},</span>
         <span class="p">{</span> <span class="o">..</span> <span class="nb">object</span> <span class="n">descriptor</span> <span class="mi">2</span> <span class="o">..</span> <span class="p">},</span>
         <span class="p">{</span> <span class="o">..</span> <span class="nb">object</span> <span class="n">descriptor</span> <span class="mi">3</span> <span class="o">..</span> <span class="p">}</span>
       <span class="p">],</span>
       <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;cursor&quot;</span><span class="p">:</span> <span class="s2">&quot;CuABChEKBGRhdGUSCQjA1LC...&quot;</span><span class="p">,</span>
       <span class="p">},</span>
       <span class="s2">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;next&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.virustotal.com/api/v3/{collection name}/{object id}/relationships/{one-to-many relationship}?cursor=CuABChEKBGRhdGUSCQjA1LC...&quot;</span><span class="p">,</span>
         <span class="s2">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.virustotal.com/api/v3/{collection name}/{object id}/relationships/{one-to-many relationship}&quot;</span>
       <span class="p">},</span>
     <span class="p">},</span>
    <span class="s2">&quot;{relationship 2}&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="o">...</span> <span class="p">},</span>
    <span class="s2">&quot;{relationship 3}&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Если вы внимательно посмотрите на поле <code class="docutils literal notranslate"><span class="pre">links</span></code> для связи в приведенном выше примере, вы увидите, что URL в поле <code class="docutils literal notranslate"><span class="pre">self</span></code> выглядит следующим образом:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">virustotal</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="p">{</span><span class="n">collection</span> <span class="n">name</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="nb">object</span> <span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">relationships</span><span class="o">/</span><span class="p">{</span><span class="n">relationship</span><span class="p">}</span>
</pre></div>
</div>
<p>Отношения «один ко многим» - это просто коллекции, содержащие объекты, которые каким-то образом связаны с основным объектом, поэтому они обычно имеют свой собственный URL, который можно использовать для перебора связанных объектов, отправляя GET-запросы на этот URL, как описано в разделе [«Коллекции»](#collections). При этом имеется два URL-адреса:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">virustotal</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="p">{</span><span class="n">collection</span> <span class="n">name</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="nb">object</span> <span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">relationships</span><span class="o">/</span><span class="p">{</span><span class="n">relationship</span><span class="p">}</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">virustotal</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="p">{</span><span class="n">collection</span> <span class="n">name</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="nb">object</span> <span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">relationship</span><span class="p">}</span>
</pre></div>
</div>
<p>Первый URL - это коллекция, содержащая только дескрипторы (тип и идентификатор) для связанных объектов, второй - полные объекты со всеми их атрибутами. Если вас интересует только тип и идентификатор связанных объектов, вы должны использовать первый, так как более эффективно извлекать только дескрипторы, чем полные объекты.</p>
<p>Еще одно важное различие между обеими конечными точками заключается в том, что <code class="docutils literal notranslate"><span class="pre">{object</span> <span class="pre">id}/relationships/{relationship}</span></code> представляет отношение как независимую сущность и может поддерживать операции, которые изменяют отношение без изменения объектов. Напротив, <code class="docutils literal notranslate"><span class="pre">{object</span> <span class="pre">id}/{relationship}</span></code> представляет связанные объекты, а не отношение. Например, если вы хотите предоставить пользователю разрешения на просмотр графика, вы можете использовать:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">virustotal</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="n">graphs</span><span class="o">/</span><span class="p">{</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">relationships</span><span class="o">/</span><span class="n">viewers</span>
</pre></div>
</div>
<p>Эта конечная точка получает пользовательский дескриптор, она не изменяет ни пользователя, ни график, она просто создает связь между ними. С другой стороны, когда вы создаете новый комментарий для файла, вы используете:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">virustotal</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="p">{</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">comments</span>
</pre></div>
</div>
<p>И в этом случае вы не только изменяете связь между файлом и комментарием, но и создаете новый объект комментария.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="endpoints.html" class="btn btn-neutral float-right" title="Основные функции VirusTotal API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="API VirusTotal (3 version)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>